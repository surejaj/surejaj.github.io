<!doctype html><html lang=en><head><title>Zynq-7000 QSPI Clock Generation :: SurejAJ's Notes</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction This article, we will explore how to configure the QSPI controller clocks on Zynq-7000. It provide a brief overview of the QSPI clock generation block and also describes the how to configure the clock frequency in UBoot and Linux kernel.
Clock Generation Hardware The QSPI Controller on the Zynq is driven by a QSPI_REF_CLK. The QSPI_REF_CLK can be sourced from either ARM, DDR and IO PLL Blocks. After selecting the, clock source, the clock is further divided using a 6-bit divisor."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/zynq-qspi-clk/><link rel=stylesheet href=/styles.css><link rel="shortcut icon" href=/img/theme-colors/orange.png><link rel=apple-touch-icon href=/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Zynq-7000 QSPI Clock Generation"><meta property="og:description" content="Introduction This article, we will explore how to configure the QSPI controller clocks on Zynq-7000. It provide a brief overview of the QSPI clock generation block and also describes the how to configure the clock frequency in UBoot and Linux kernel.
Clock Generation Hardware The QSPI Controller on the Zynq is driven by a QSPI_REF_CLK. The QSPI_REF_CLK can be sourced from either ARM, DDR and IO PLL Blocks. After selecting the, clock source, the clock is further divided using a 6-bit divisor."><meta property="og:url" content="/posts/zynq-qspi-clk/"><meta property="og:site_name" content="SurejAJ's Notes"><meta property="og:image" content="/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2023-01-05 22:36:07 -0600 CST"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>SurejAJ's Notes</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/aboutme>About Me</a></li><li><a href=/>Home</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/aboutme>About Me</a></li><li><a href=/>Home</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=/posts/zynq-qspi-clk/>Zynq-7000 QSPI Clock Generation</a></h1><div class=post-meta><time class=post-date>2023-01-05 ::
</time><span class=post-reading-time>:: 2 min read (221 words)</span></div><span class=post-tags>#<a href=/tags/zynq-7000/>Zynq-7000</a>&nbsp;
#<a href=/tags/fpga/>FPGA</a>&nbsp;
#<a href=/tags/kernel/>Kernel</a>&nbsp;
#<a href=/tags/qspi/>QSPI</a>&nbsp;</span><div class=post-content><div><h1 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h1><hr><p>This article, we will explore how to configure the QSPI controller clocks
on Zynq-7000. It provide a brief overview of the QSPI clock generation block
and also describes the how to configure the clock frequency in UBoot and Linux
kernel.</p><h1 id=clock-generation-hardware>Clock Generation Hardware<a href=#clock-generation-hardware class=hanchor arialabel=Anchor>&#8983;</a></h1><hr><p>The QSPI Controller on the Zynq is driven by a QSPI_REF_CLK. The QSPI_REF_CLK
can be sourced from either ARM, DDR and IO PLL Blocks. After selecting the,
clock source, the clock is further divided using a 6-bit divisor. The divided
clock is passed through a clock gating block. Below is a block diagram
for the QSPI_REF_CLK generation:</p><figure class=left><img src=./images/zynq_qspi_clk_blk.svg></figure><p>The QSPI_REF_CLK is generated by first selecting the PLL Block and then applying
a divisor. The divisor value can range from 0 to 128. This divisor value is
specified in Vivado:</p><figure class=left><img src=./images/vivado_qspi_ref_clk.jpg></figure><p>In the above example, the QSPI_REF_CLK is sourced from IO PLL. The IO PLL
clock frequency is 1600Mhz. A divisor value of 20 is applied to device a 80Mhz
QSPI_REF_CLK.</p><p>To generate the Quad-SPI interface clock, the QSPI_REF_CLK is divided down by 2,
4, 8, 16, 32, 64, 128, or 256 using the qspi.Config_reg [BAUD_RATE_DIV] bit field.</p><h4 id=u-boot-qspi-clock-setting>U-Boot QSPI Clock Setting<a href=#u-boot-qspi-clock-setting class=hanchor arialabel=Anchor>&#8983;</a></h4><h5 id=linux-kernel-qspi-clock-setting>Linux Kernel QSPI Clock Setting<a href=#linux-kernel-qspi-clock-setting class=hanchor arialabel=Anchor>&#8983;</a></h5><pre tabindex=0><code>@qspi {
	status = &#34;okay&#34;;

	flash@0 {
		spi-max-frequency = &lt;40000000&gt;;
  };
};
</code></pre><h1 id=reference>Reference<a href=#reference class=hanchor arialabel=Anchor>&#8983;</a></h1><ol><li>Zynq TRM Page number 359</li><li>Zynq TRM Page number 688</li></ol></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2024 Surej Joseph Powered by <a href=http://gohugo.io>Hugo</span></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>