<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>QSPI on SurejAJ's Notes</title><link>/tags/qspi/</link><description>Recent content in QSPI on SurejAJ's Notes</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Surej Joseph</copyright><lastBuildDate>Thu, 05 Jan 2023 22:36:07 -0600</lastBuildDate><atom:link href="/tags/qspi/index.xml" rel="self" type="application/rss+xml"/><item><title>Zynq-7000 QSPI Clock Generation</title><link>/posts/zynq-qspi-clk/</link><pubDate>Thu, 05 Jan 2023 22:36:07 -0600</pubDate><guid>/posts/zynq-qspi-clk/</guid><description>Introduction This article, we will explore how to configure the QSPI controller clocks on Zynq-7000. It provide a brief overview of the QSPI clock generation block and also describes the how to configure the clock frequency in UBoot and Linux kernel.
Clock Generation Hardware The QSPI Controller on the Zynq is driven by a QSPI_REF_CLK. The QSPI_REF_CLK can be sourced from either ARM, DDR and IO PLL Blocks. After selecting the, clock source, the clock is further divided using a 6-bit divisor.</description><content>&lt;h1 id="introduction">Introduction&lt;/h1>
&lt;hr>
&lt;p>This article, we will explore how to configure the QSPI controller clocks
on Zynq-7000. It provide a brief overview of the QSPI clock generation block
and also describes the how to configure the clock frequency in UBoot and Linux
kernel.&lt;/p>
&lt;h1 id="clock-generation-hardware">Clock Generation Hardware&lt;/h1>
&lt;hr>
&lt;p>The QSPI Controller on the Zynq is driven by a QSPI_REF_CLK. The QSPI_REF_CLK
can be sourced from either ARM, DDR and IO PLL Blocks. After selecting the,
clock source, the clock is further divided using a 6-bit divisor. The divided
clock is passed through a clock gating block. Below is a block diagram
for the QSPI_REF_CLK generation:&lt;/p>
&lt;figure class="left" >
&lt;img src="./images/zynq_qspi_clk_blk.svg" />
&lt;/figure>
&lt;p>The QSPI_REF_CLK is generated by first selecting the PLL Block and then applying
a divisor. The divisor value can range from 0 to 128. This divisor value is
specified in Vivado:&lt;/p>
&lt;figure class="left" >
&lt;img src="./images/vivado_qspi_ref_clk.jpg" />
&lt;/figure>
&lt;p>In the above example, the QSPI_REF_CLK is sourced from IO PLL. The IO PLL
clock frequency is 1600Mhz. A divisor value of 20 is applied to device a 80Mhz
QSPI_REF_CLK.&lt;/p>
&lt;p>To generate the Quad-SPI interface clock, the QSPI_REF_CLK is divided down by 2,
4, 8, 16, 32, 64, 128, or 256 using the qspi.Config_reg [BAUD_RATE_DIV] bit field.&lt;/p>
&lt;h4 id="u-boot-qspi-clock-setting">U-Boot QSPI Clock Setting&lt;/h4>
&lt;h5 id="linux-kernel-qspi-clock-setting">Linux Kernel QSPI Clock Setting&lt;/h5>
&lt;pre tabindex="0">&lt;code>@qspi {
status = &amp;#34;okay&amp;#34;;
flash@0 {
spi-max-frequency = &amp;lt;40000000&amp;gt;;
};
};
&lt;/code>&lt;/pre>&lt;h1 id="reference">Reference&lt;/h1>
&lt;ol>
&lt;li>Zynq TRM Page number 359&lt;/li>
&lt;li>Zynq TRM Page number 688&lt;/li>
&lt;/ol></content></item></channel></rss>